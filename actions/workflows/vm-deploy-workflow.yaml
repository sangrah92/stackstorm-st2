version: 1.0
description: A workflow to crate resource group and deploy VM and get status of resource creation in azure portal.
input:
  - client_id
  - serect
  - tanent_id
  - subscription_number
  - resource_group
  - region
  - template_file

vars:
  - result: ''
  - error: ''

tasks:
  authenticate:
    action: dd_shieldx.authenticate 
    input: 
      client_id: <% ctx(client_id) %> 
      serect: <% ctx(serect) %> 
      tanent_id: <% ctx(tanent_id) %> 
      subscription_number: <% ctx(subscription_number) %> 
      resource_group: <% ctx(resource_group) %> 
      region: <% ctx(region) %> 
      template_file: <% ctx(template_file) %>
    next:
      - when: <% succeeded() %>
        publish:
          - result: "{{ result() }}"
  
output:
  - result: '{{ task(authenticate).result.result.data  }}'
  - error: '{{ ctx().error }}'        
